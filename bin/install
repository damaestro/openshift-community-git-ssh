#!/bin/bash -e

case "$1" in
  -v|--version)
    version="$2"
esac

source $OPENSHIFT_CARTRIDGE_SDK_BASH

ssh-keygen -b 4096 -N '' -f ${OPENSHIFT_DATA_DIR}/git-ssh/id_rsa > /dev/null
sed -i "s/@$HOSTNAME/@$OPENSHIFT_APP_DNS/g" ${OPENSHIFT_DATA_DIR}/git-ssh/id_rsa.pub
gitssh_public_key=$(cat ${OPENSHIFT_DATA_DIR}/git-ssh/id_rsa.pub)

client_result ""
client_result "  GIT_SSH configured successfully for GitHub."
client_result "  Please add the following public key to your repo(s):"
client_result ""
client_result "$gitssh_public_key"
client_result ""
client_result "  Note: You can replace this autogenerated keypair at: \${OPENSHIFT_DATA_DIR}/git-ssh"
client_result ""
